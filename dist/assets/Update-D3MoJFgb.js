import{f as k,i as D,m as I,l as F,n as P,r as u,a as S,j as e,k as r}from"./index-DuLuWPBD.js";import{L as C}from"./index-CVx9NNeg.js";const T=()=>{var x;const{user:n}=k(t=>t.user),l=D(),[f]=I(),{data:s,isLoading:b}=F({userId:n._id,postId:l.id}),[j,{isLoading:p}]=P({userId:n._id,postId:l.id}),[c,h]=u.useState(""),[d,m]=u.useState(""),y=S(),g=C("multiple",5);u.useEffect(()=>{s!=null&&s.post&&(h(s.post.title),m(s.post.description))},[s]);const v=async t=>{var o;if(t.preventDefault(),!c||!d){r.error("Title and description are required");return}const a=new FormData;a.set("title",c),a.set("description",d),(g.file||[]).forEach(i=>{a.append("photos",i)});try{const i=await j({id:n._id,postId:l.id,postData:a});i.error?r.error(((o=i.error.data)==null?void 0:o.message)||"An error occurred while updating the post"):(r.success("Post updated successfully!"),y("/admin"))}catch(i){r.error(`An error occurred while updating the post: ${i.message}`)}},w=t=>{if(t.target.files.length>5){r.error("You can upload a maximum of 5 files");return}g.changeHandler(t)},N=async t=>{const a=l.id;try{const{data:o}=await f({postId:a,imageId:t});o.success?r.success(o.message):r.error("Failed to delete")}catch(o){r.error(`An error occurred while creating the post ${o}`)}};return b?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("p",{children:"Loading..."})}):e.jsx("div",{className:"bg-gray-600 min-h-screen flex justify-center pt-20",children:e.jsxs("div",{className:"bg-white min-h-screen w-1/2 rounded-2xl",children:[e.jsx("div",{className:"flex justify-center items-center flex-wrap gap-4",children:(x=s==null?void 0:s.post)==null?void 0:x.photos.map(t=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{className:"m-2 w-32 h-32 object-cover rounded-lg",src:t.url,alt:"Not available"}),e.jsx("button",{onClick:()=>N(t.public_id),className:"absolute top-0 right-0 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:"Ã—"})]},t._id))}),e.jsxs("form",{className:"flex flex-col space-y-6 px-7",onSubmit:v,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"mb-2 text-lg block",children:"Title"}),e.jsx("input",{id:"title",type:"text",placeholder:"Enter Title",value:c,onChange:t=>h(t.target.value),className:"px-4 py-2.5 text-lg rounded-md bg-white border border-gray-400 w-full outline-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"mb-2 text-base block",children:"Description"}),e.jsx("textarea",{id:"description",placeholder:"Type Message",value:d,onChange:t=>m(t.target.value),className:"p-4 bg-white mx-auto w-full h-full block text-sm border border-gray-400 outline-[#007bff] rounded",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photos",className:"mb-2 text-base block",children:"Photos"}),e.jsx("input",{id:"photos",type:"file",accept:"image/*",multiple:!0,onChange:w})]}),e.jsx("button",{type:"submit",disabled:p,className:"bg-black text-white h-10 rounded-2xl hover:bg-blue-900",children:p?"Updating...":"Update"})]})]})})};export{T as default};
